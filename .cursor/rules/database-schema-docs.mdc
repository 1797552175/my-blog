---
description: 新增/修改数据库表时必须维护字段 COMMENT 与 PROJECT_SPEC.md 表结构文档
alwaysApply: true
---

# 数据库表与文档维护规则

凡**新增表**或**修改表结构**（新增/改字段、改类型）时，必须同时完成以下两件事，否则视为未完成。

## 1. 为数据库字段加上 COMMENT（方便在库中直接看懂）

任选一种方式，保证每个字段在库里都有中文说明：

- **推荐：Flyway 迁移**  
  在 `apps/api/src/main/resources/db/migration/` 下新增或修改迁移脚本，对每个列执行 `MODIFY COLUMN ... COMMENT '中文说明'`。  
  可参考已有 `V12__add_column_comments.sql` 的写法。
- **或：建表/改表时直接写 COMMENT**  
  在迁移里建表或加列时，在列定义中写上 `COMMENT '中文说明'`。

不要出现“新表/新字段在库里没有任何 COMMENT”的情况。

## 2. 把表结构维护到 docs/PROJECT_SPEC.md

在 **docs/PROJECT_SPEC.md** 的 **第 3 节「数据库表结构」** 中：

- **新表**：按现有格式新增一小节（如 3.30 xxx 表），包含：
  - 表名与中文说明；
  - 表格：字段名 | 类型 | 约束 | 备注；
  - 索引、外键、唯一约束等说明。
- **改表**：找到对应小节，增/改/删字段行，并更新索引与外键说明，保证与当前库结构一致。

格式与现有 3.1～3.29 保持一致（字段名、类型、约束、备注四列）。

## 检查清单（做完再收尾）

- [ ] 新表/新列在数据库里都有 COMMENT（通过迁移或建表语句）
- [ ] PROJECT_SPEC.md 第 3 节已更新：新表有小节，改表已改对应小节
- [ ] 表名、字段名、类型、约束、备注与当前代码/迁移一致

## 参考

- 表结构文档位置：`docs/PROJECT_SPEC.md` 第 3 节
- 迁移脚本目录：`apps/api/src/main/resources/db/migration/`
- 列注释示例：`V12__add_column_comments.sql`
